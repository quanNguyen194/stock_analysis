{"remainingRequest":"/home/quan/Documents/Projects/django-vue/frontend_test/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/quan/Documents/Projects/django-vue/frontend_test/src/views/user/menu-detail/modals/discount-list.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/quan/Documents/Projects/django-vue/frontend_test/src/views/user/menu-detail/modals/discount-list.vue","mtime":1615822194522},{"path":"/home/quan/Documents/Projects/django-vue/frontend_test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/quan/Documents/Projects/django-vue/frontend_test/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/quan/Documents/Projects/django-vue/frontend_test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/quan/Documents/Projects/django-vue/frontend_test/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Modal from '@/components/partials/modal'\nimport Button from '@/components/partials/button'\nimport MenuApi from '@/services/menu'\nimport DishApi from '@/services/dish'\nimport { doSearchInArray } from '@/plugins/jpconverter'\nimport { categories } from '../../../../constants/material'\nimport { mapGetters } from 'vuex'\n\nexport default {\n  components: {\n    Modal,\n    Button\n  },\n\n  props: {\n    onClose: {\n      type: Function\n    },\n    menu: {\n      type: Object\n    },\n    dish: {\n      type: Object\n    },\n    currentDishIndex: {\n      type: Number\n    }\n  },\n\n  selected: '',\n\n  async mounted () {\n    this.dishes = await DishApi.listDish()\n    this.checkedDish = this.menu.dishes.map(d => d._id)\n    this.searchData = this.dishes\n    // console.log(this.checkedDish)\n  },\n\n  data () {\n    return {\n      search: '',\n      dishes: [],\n      checkedDish: [],\n      categories: ['すべて', ...categories],\n      modal_visible: false,\n      deleteId: '',\n      deleteIndex: '',\n      searchData: [],\n      searchTimeOut: null,\n      filterCate: 'すべて'\n    }\n  },\n  watch: {\n    search (value) {\n      if (this.searchTimeOut !== null) {\n        // if (this.filterCate !== 'すべて') {\n        //   this.filterCate = this.filterCate\n        // }\n        clearTimeout(this.searchTimeOut)\n      }\n\n      const dishes = this.dishes\n      this.searchTimeOut = setTimeout(async () => {\n        this.searchData = await doSearchInArray(value, dishes)\n      }, 400)\n    }\n  },\n  methods: {\n    // filterSearchData () {\n    //   return this.searchData.filter(e => {\n    //     if (this.filterCate === 'すべて' || !this.filterCate.length) {\n    //       return true\n    //     } else {\n    //       return e.category.split('-').reverse()[0] === this.filterCate.split('-').reverse()[0]\n    //     }\n    //   })\n    // },\n    async saveToMenu () {\n      await MenuApi.updateMenu(this.menu._id, {\n        dishes: this.checkedDish\n      })\n      this.$router.go()\n    },\n    toggleVisible (id, index) {\n      this.modal_visible = !this.modal_visible\n      this.deleteId = id\n      this.deleteIndex = index\n    },\n    async deleteDish (id, index) {\n      const dishesFilter = this.filterSearchData()\n      // console.log(dishesFilter)\n      const res = await DishApi.deleteDishPermanently(id)\n      if (res.status) {\n        dishesFilter.splice(index, 1)\n        this.searchData = dishesFilter\n        // console.log('2', dishesFilter)\n      }\n      this.modal_visible = false\n    }\n  },\n  computed: {\n    ...mapGetters({ isLoading: 'isLoading' }),\n    filterSearchData () {\n      // Do not delete this line\n      // Don't know why?\n      // console.log(this.currentDishIndex)\n      return this.searchData.filter(e => {\n        if (this.filterCate === 'すべて' || !this.filterCate.length) {\n          return true\n        } else {\n          return e.category.split('-').reverse()[0] === this.filterCate.split('-').reverse()[0]\n        }\n      })\n    }\n  }\n}\n",{"version":3,"sources":["discount-list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"discount-list.vue","sourceRoot":"src/views/user/menu-detail/modals","sourcesContent":["<template>\n  <Modal title=\"割一覧\" @updateModalVisible=\"onClose()\" width=\"90%\">\n    <div class=\"check__material\">\n      <div class=\"row\">\n<!--        <div class=\"col-md-1 material__title\">割名</div>-->\n<!--        <div class=\"col-md-4 menu__textbox\">-->\n<!--          <TextBox-->\n<!--            type=\"String\"-->\n<!--            v-model=\"search\"-->\n<!--            placeholder=\"割名\"-->\n<!--            pleft=\"14px\"-->\n<!--            autocomplete=\"off\"-->\n<!--          />-->\n<!--        </div>-->\n\n        <div class=\"filterCategory row\">\n          <div class=\"col-md-3\">\n            <input\n              type=\"text\"\n              placeholder=\"割名\"\n              v-model=\"search\"\n            >\n          </div>\n\n          <form class=\"col-md-9 menu__mass\">\n            <label class=\"cate--filter\">分類</label>\n            <span v-for=\"(cate, key) in categories\" :key=\"key\">\n              <input\n                type=\"radio\"\n                name=\"unit\"\n                :value=\"cate\"\n                :id=\"cate\"\n                v-model=\"filterCate\"\n              >\n              <label :for=\"cate\">{{cate.split('-').reverse()[0]}}</label>\n            </span>\n          </form>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"materials__table\">\n      <div v-for=\"(dish, index) in filterSearchData\" :key=\"index\" class=\"row mate__list\">\n        <div class=\" mate__input\">\n          <input type=\"checkbox\"\n               name=\"checkbox\"\n               :value=\"dish._id\"\n               v-model=\"checkedDish\"\n               :checked=\"true\"\n          >\n        </div>\n        <div class=\" mate__name\">{{dish.name}}</div>\n        <div class=\" mate__cat\">{{dish.category.split('-').reverse()[0]}}</div>\n        <div class=\"mate__unit\">\n            <span v-for=\"(m, i) in dish.materials\" :key=\"i\">\n              <a class=\"material__button\">{{`${m.name} ${m.value}${m.unit}`}}</a>\n            </span>\n        </div>\n        <div class=\"action\">\n<!--          <Button class=\"dish__delete\"-->\n<!--                  :click=\"() => toggleVisible(dish._id,index)\">-->\n<!--            <div class=\"action-icon\">×</div>-->\n<!--          </Button>-->\n          <a class=\"btn__delete\" @click=\"toggleVisible(dish._id,index)\">×</a>\n          <Button :click=\"() => toggleVisible(dish._id,index)\" class=\"menu__button--del\">\n            <span>削除</span>\n          </Button>\n        </div>\n        <div class=\"clear\"></div>\n      </div>\n    </div>\n    <div class=\"modal-confirm\">\n      <Modal title=\"割の削除\" v-if=\"modal_visible\" @updateModalVisible=\"modal_visible = false\" width=\"50%\">\n        <p style=\"font-weight: bold\" class=\"text-left\">\n          削除すると、もとに戻すことはできません。 <br>\n          それでもよろしい場合は削除を選択してください。\n        </p>\n        <template slot=\"footer\">\n          <div @click=\"() => toggleVisible()\" class=\"not_delete\">\n            <Button background-color=\"#fff\" color=\"#24374e\" border-color=\"#24374e\">キャンセル</Button>\n          </div>\n          <div class=\"deleted\">\n            <Button :click=\"() => deleteDish(deleteId,deleteIndex)\" border-color=\"#24374e\">削除</Button>\n          </div>\n        </template>\n      </Modal>\n    </div>\n\n    <template slot=\"footer\">\n      <Button :click=\"onClose\" backgroundColor=\"#fff\" color=\"#151e5d\" width=\"150px\">キャンセル</Button>\n      <Button :click=\"saveToMenu\" width=\"150px\">決定する</Button>\n    </template>\n  </Modal>\n</template>\n\n<script>\nimport Modal from '@/components/partials/modal'\nimport Button from '@/components/partials/button'\nimport MenuApi from '@/services/menu'\nimport DishApi from '@/services/dish'\nimport { doSearchInArray } from '@/plugins/jpconverter'\nimport { categories } from '../../../../constants/material'\nimport { mapGetters } from 'vuex'\n\nexport default {\n  components: {\n    Modal,\n    Button\n  },\n\n  props: {\n    onClose: {\n      type: Function\n    },\n    menu: {\n      type: Object\n    },\n    dish: {\n      type: Object\n    },\n    currentDishIndex: {\n      type: Number\n    }\n  },\n\n  selected: '',\n\n  async mounted () {\n    this.dishes = await DishApi.listDish()\n    this.checkedDish = this.menu.dishes.map(d => d._id)\n    this.searchData = this.dishes\n    // console.log(this.checkedDish)\n  },\n\n  data () {\n    return {\n      search: '',\n      dishes: [],\n      checkedDish: [],\n      categories: ['すべて', ...categories],\n      modal_visible: false,\n      deleteId: '',\n      deleteIndex: '',\n      searchData: [],\n      searchTimeOut: null,\n      filterCate: 'すべて'\n    }\n  },\n  watch: {\n    search (value) {\n      if (this.searchTimeOut !== null) {\n        // if (this.filterCate !== 'すべて') {\n        //   this.filterCate = this.filterCate\n        // }\n        clearTimeout(this.searchTimeOut)\n      }\n\n      const dishes = this.dishes\n      this.searchTimeOut = setTimeout(async () => {\n        this.searchData = await doSearchInArray(value, dishes)\n      }, 400)\n    }\n  },\n  methods: {\n    // filterSearchData () {\n    //   return this.searchData.filter(e => {\n    //     if (this.filterCate === 'すべて' || !this.filterCate.length) {\n    //       return true\n    //     } else {\n    //       return e.category.split('-').reverse()[0] === this.filterCate.split('-').reverse()[0]\n    //     }\n    //   })\n    // },\n    async saveToMenu () {\n      await MenuApi.updateMenu(this.menu._id, {\n        dishes: this.checkedDish\n      })\n      this.$router.go()\n    },\n    toggleVisible (id, index) {\n      this.modal_visible = !this.modal_visible\n      this.deleteId = id\n      this.deleteIndex = index\n    },\n    async deleteDish (id, index) {\n      const dishesFilter = this.filterSearchData()\n      // console.log(dishesFilter)\n      const res = await DishApi.deleteDishPermanently(id)\n      if (res.status) {\n        dishesFilter.splice(index, 1)\n        this.searchData = dishesFilter\n        // console.log('2', dishesFilter)\n      }\n      this.modal_visible = false\n    }\n  },\n  computed: {\n    ...mapGetters({ isLoading: 'isLoading' }),\n    filterSearchData () {\n      // Do not delete this line\n      // Don't know why?\n      // console.log(this.currentDishIndex)\n      return this.searchData.filter(e => {\n        if (this.filterCate === 'すべて' || !this.filterCate.length) {\n          return true\n        } else {\n          return e.category.split('-').reverse()[0] === this.filterCate.split('-').reverse()[0]\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style  lang=\"scss\" scoped>\n  .menu__textbox {\n    margin-bottom: 16px;\n  }\n\n  a {\n    cursor: pointer;\n  }\n\n  .menu__input {\n    width: 100%;\n    padding: 16px 0;\n    border: 1px solid #d8d8d8;\n    margin-bottom: 30px;\n    label {\n      font-size: 14px;\n      font-weight: bold;\n      margin: 0 16px;\n    }\n\n    @media only screen and (max-width: 400px) {\n      width: 100%;\n    }\n  }\n\n  .materials__table {\n    width: 100%;\n    font-size: 16px;\n    border-top: 1px solid #d8d8d8;\n\n    .mate__list {\n      padding: 10px;\n      border-bottom: 1px solid #d8d8d8;\n    }\n\n    .mate__input {\n      width: 5%;\n      float: left;\n    }\n\n    .mate__name {\n      width: 15%;\n      float: left;\n    }\n\n    .mate__cat {\n      width: 15%;\n      float: left;\n    }\n\n    .mate__unit {\n      width: 56%;\n      float: left;\n    }\n    .action{\n      display: inline-block;\n      margin: 10px;\n      float: right;\n      vertical-align: top;\n\n      &-icon {\n        display: block;\n        margin: auto;\n        transform: translate(3%, -10%);\n      }\n    }\n\n    @media only screen and (max-width: 992px) {\n      .action {\n        margin-right: 45%\n      }\n    }\n\n    @media only screen and (max-width: 767px) {\n      .mate__input {\n        width: 15%;\n      }\n\n      .mate__name {\n        width: 45%;\n        margin-bottom: 10px;\n      }\n\n      .mate__cat {\n        width: 40%;\n        text-align: right;\n      }\n\n      .mate__unit {\n        width: 85%;\n        float: right;\n      }\n    }\n  }\n\n  .deleted {\n    width: 100px;\n    margin-left: 15px;\n  }\n\n  .not_delete {\n    width: 100px;\n    margin-right: 15px;\n  }\n\ninput {\n  width: 28px;\n  height: 28px;\n  vertical-align: middle;\n  outline: none;\n}\n\n.material__button {\n  display: inline-block;\n  margin: 5px 0;\n  padding: 10px;\n  color: #44a0e5;\n  border-radius: 4px;\n  border: 1px solid #44a0e5;\n  margin-right: 10px;\n  overflow: auto;\n}\n\n.material__title {\n  margin-bottom: 10px;\n  font-weight: bold;\n  font-size: 16px;\n}\n\n  .menu__button--del {\n    width: 150px !important;\n    padding: 3px;\n    text-align: center;\n    margin: 0 !important;\n    display: none;\n    background-color: red !important;\n    color: #ffffff !important;\n  }\n\n  .dish__delete {\n    background-color: red !important;\n    color: #ffffff !important;\n    border-radius: 50% !important;\n    border: none;\n    width: 30px !important;\n    height: 30px !important;\n    font-size: 22px !important;\n  }\n\n  .filterCategory {\n    width: 100%;\n    border: 1px solid #d8d8d8;\n    background-color: #ffffff;\n    margin-bottom: 30px;\n\n    .col-md-3 {\n      padding: 0;\n      @media only screen and (max-width: 1720px) {\n        margin-top: 23px;\n      }\n      input {\n        width: 98%;\n        height: 34px;\n        padding: 5px 10px;\n        margin: 4px;\n        outline: none;\n        @media only screen and (max-width: 1720px) {\n          border: 1px solid #d8d8d8;\n        }\n      }\n    }\n\n  }\n\n  .btn__delete {\n    color: #ffffff;\n    background-color: red;\n    font-size: 22px;\n    text-align: center;\n    width: 32px;\n    height: 30px;\n    border-radius: 50%;\n    padding: 1px 8px;\n    margin-left: 20px;\n  }\n\n  .menu__mass {\n    color: #151e5d;\n    padding: 10px 5px;\n    border-left: 1px solid #d8d8d8;\n    /*margin-bottom: 10px;*/\n\n    span {\n      display: inline-block;\n    }\n\n    input {\n      width: 18px;\n      height: 20px;\n      vertical-align: sub;\n      outline: none;\n    }\n\n    label {\n      font-size: 13px;\n      font-weight: bold;\n      margin: 0 18px 0 8px;\n    }\n\n    .cate--filter {\n      margin: 0 50px 0 0;\n      font-size: 15px;\n      @media only screen and (max-width: 1720px) {\n        display: block;\n        padding-bottom: 10px;\n      }\n    }\n\n    @media only screen and (max-width: 992px) {\n      span {\n        width: 33%;\n      }\n    }\n\n    @media only screen and (max-width: 500px) {\n      width: 100%;\n      margin-bottom: 5px;\n      border-left: none;\n      .sort__btn {\n        width: 33%;\n      }\n\n      label {\n        font-size: 11px;\n      }\n      span {\n        width: 50%;\n        margin-bottom: 5px;\n      }\n    }\n  }\n\n  @media only screen and (max-width: 992px) {\n    .menu__button--del {\n      display: inline-block;\n    }\n\n    .btn__delete {\n      display: none;\n    }\n  }\n\n</style>\n"]}]}