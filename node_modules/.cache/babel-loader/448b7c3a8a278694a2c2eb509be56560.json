{"remainingRequest":"/home/quan/Documents/Projects/stock_analysis/node_modules/babel-loader/lib/index.js!/home/quan/Documents/Projects/stock_analysis/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/quan/Documents/Projects/stock_analysis/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/quan/Documents/Projects/stock_analysis/src/views/user/menu-detail/export.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/quan/Documents/Projects/stock_analysis/src/views/user/menu-detail/export.vue","mtime":1615822194522},{"path":"/home/quan/Documents/Projects/stock_analysis/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/quan/Documents/Projects/stock_analysis/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/quan/Documents/Projects/stock_analysis/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/quan/Documents/Projects/stock_analysis/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.object.define-property\";\nimport \"core-js/modules/es6.object.define-properties\";\nimport \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.array.index-of\";\nimport \"core-js/modules/es6.regexp.flags\";\nimport \"core-js/modules/es6.array.reduce\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.for-each\";\nimport \"core-js/modules/es6.array.map\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.array.filter\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/quan/Documents/Projects/stock_analysis/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/home/quan/Documents/Projects/stock_analysis/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport MenuApi from '@/services/menu';\nimport sortMethods from '@/utils/sort';\nimport PdfLayout from '@/views/layouts/pdf';\nimport { mapActions, mapGetters } from 'vuex';\nimport { SET_LOADING } from '@/store/types';\nexport default {\n  components: {\n    PdfLayout: PdfLayout\n  },\n  data: function data() {\n    return {\n      name: '',\n      note: '',\n      totalDishes: [],\n      sortedDishes: [],\n      currentIndex: 0,\n      perPage: 25,\n      heightSet: false,\n      //\n      pagesData: [],\n      flags: {\n        showTempList: true\n      },\n      emptyHeight: 0,\n      startIndex: [],\n      currentSort: ''\n    };\n  },\n  computed: _objectSpread({}, mapGetters({\n    store: 'store',\n    company: 'company'\n  })),\n  mounted: function () {\n    var _mounted = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n      var _this = this;\n\n      var currentMenu, filterCate;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              // window.alert(this.getOS())\n              this.setLoading(true);\n              _context.next = 3;\n              return MenuApi.getDetails(this.$route.params.id);\n\n            case 3:\n              currentMenu = _context.sent;\n              filterCate = this.$route.query.filter;\n              this.totalDishes = currentMenu.dishes.filter(function (e) {\n                if (filterCate === 'すべて' || !filterCate.length) {\n                  return true;\n                } else {\n                  return e.category === filterCate;\n                }\n              });\n              this.totalDishes = this.$route.query.sort_by ? sortMethods.sort(this.totalDishes, this.$route.query.sort_by) : this.totalDishes;\n              console.log(this.totalDishes);\n              this.name = currentMenu.name;\n              this.note = currentMenu.note;\n              this.startIndex[0] = 0;\n              setTimeout(function () {\n                var tableHeight = _this.$refs['subpage'].offsetHeight - (10 + 37.795275591 + 25 + 21 + 80);\n                var noteHeight = _this.$refs.note.offsetHeight; // if (this.getOS() === 'iOS') {\n                //   noteHeight = this.$refs.note.offsetHeight * 0.7\n                // } else {\n                //   noteHeight = this.$refs.note.offsetHeight\n                // }\n\n                var totalTableHeight = 0;\n                var currentPage = 0;\n                var cutIndex = 0;\n\n                if (_this.totalDishes.length) {\n                  var rowsHeight = _this.$refs['dishes__list'].map(function (e) {\n                    return e.offsetHeight;\n                  });\n\n                  var page = [[]];\n                  rowsHeight.forEach(function (height, index) {\n                    // window.alert('row height: ' + height)\n                    if (totalTableHeight >= tableHeight) {\n                      totalTableHeight = 0;\n                      currentPage = currentPage + 1;\n                      page[currentPage] = [];\n                      cutIndex += page[currentPage - 1].length;\n                      _this.startIndex[currentPage] = cutIndex;\n                    }\n\n                    page[currentPage].push(_this.totalDishes[index]);\n\n                    if (_this.getOS() === 'iOS') {\n                      totalTableHeight += height * 0.65;\n                    } else {\n                      totalTableHeight += height;\n                    } // empty = tableHeight - this.$refs.note.offsetHeight - totalTableHeight\n\n                  });\n                  _this.pagesData = page;\n                  var sum = rowsHeight.filter(function (e, i) {\n                    return i >= cutIndex;\n                  }).reduce(function (a, b) {\n                    return a + b;\n                  }, 0);\n                  _this.emptyHeight = tableHeight - noteHeight - sum;\n\n                  if (_this.emptyHeight < 0) {\n                    currentPage = currentPage + 1;\n\n                    _this.pagesData.push([]);\n\n                    _this.emptyHeight = tableHeight - noteHeight;\n                  }\n                } else {\n                  _this.pagesData = [[]];\n                  _this.emptyHeight = tableHeight - noteHeight;\n                }\n\n                _this.heightSet = true; // remove temp page\n\n                _this.flags.showTempList = false;\n\n                _this.setLoading(false);\n              }, 200);\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function mounted() {\n      return _mounted.apply(this, arguments);\n    }\n\n    return mounted;\n  }(),\n  methods: _objectSpread(_objectSpread({}, mapActions({\n    setLoading: SET_LOADING\n  })), {}, {\n    dishesOfPage: function dishesOfPage(currentPage) {\n      if (currentPage === this.totalPage) {\n        return this.totalDishes.slice((currentPage - 1) * 25, this.totalDishes.length - (currentPage - 1) * 25);\n      }\n\n      return this.totalDishes.slice((currentPage - 1) * 25, 25);\n    },\n    printWindow: function printWindow() {\n      window.print();\n    },\n    getOS: function getOS() {\n      var userAgent = window.navigator.userAgent;\n      var platform = window.navigator.platform;\n      var macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'];\n      var windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE'];\n      var iosPlatforms = ['iPhone', 'iPod'];\n      var os = null;\n\n      if (macosPlatforms.indexOf(platform) !== -1) {\n        os = 'Mac OS';\n      } else if (iosPlatforms.indexOf(platform) !== -1) {\n        os = 'iOS';\n      } else if (windowsPlatforms.indexOf(platform) !== -1) {\n        os = 'Windows';\n      } else if (/Android/.test(userAgent)) {\n        os = 'Android';\n      } else if (!os && /Linux/.test(platform)) {\n        os = 'Linux';\n      }\n\n      return os;\n    }\n  })\n};",{"version":3,"sources":["export.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <pdf-layout>\n    <div>\n      <div class=\"page\" v-if=\"flags.showTempList\">\n        <div class=\"subpage\" ref=\"subpage\">\n          <div class=\"menu-title\">\n            <div class=\"fleft\">\n              <h5 class=\"name\">\n                {{ name }}\n              </h5>\n            </div>\n            <div class=\"fright\" style=\"font-size: 13px\">1/1</div>\n            <div class=\"clear\"></div>\n          </div>\n          <div class=\"table\" ref=\"table\">\n            <div class=\"table-content\">\n              <div class=\"table-header\" ref=\"table-header\">\n                <div class=\"tr\">\n                  <div class=\"td table-index\">#</div>\n                  <div class=\"td table-name\">割名</div>\n                  <div class=\"td table-material\">材料名</div>\n                </div>\n              </div>\n              <div class=\"table-body\" ref=\"table-body\">\n                <div ref=\"filled_list\">\n                  <div class=\"tr\"\n                       ref=\"dishes__list\"\n                       v-for=\"(dish, index) in totalDishes\"\n                       :key=\"`dish-${index}`\"\n                  >\n                    <div class=\"td table-index\"></div>\n                    <div class=\"td table-name\">{{ dish.name }}</div>\n                    <div class=\"td table-material\">\n                    <span\n                      v-for=\"(mat, matIndex) in dish.materials.map(\n                        e => `【${e.name}: ${e.value}${e.unit}】`\n                      )\"\n                      :key=\"`mat-${matIndex}`\"\n                      style=\"white-space: normal\"\n                    >\n                      {{ mat }}\n                    </span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"note\" ref=\"note\">{{ note }}</div>\n          <div class=\"page_footer\">\n            <span style=\"margin-right: 10px\">{{ company.name }}</span>\n            <span>{{ store.name }}</span>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"page\" v-for=\"(dishes, index) in pagesData\" :key=\"`page-${index}`\" :id=\"`page-${index}`\">\n        <div class=\"subpage\" ref=\"subpage\" :id=\"`subpage-${index}`\">\n          <div class=\"menu-title\">\n            <div class=\"fleft\">\n              <h5 class=\"name\">\n                {{ name }}\n              </h5>\n            </div>\n            <div class=\"fright\" style=\"font-size: 13px\">\n              {{ index + 1 }}/{{ pagesData.length }}\n            </div>\n            <div class=\"clear\"></div>\n          </div>\n          <div class=\"table\" ref=\"table\">\n            <div class=\"table-content\">\n              <div class=\"table-header\" ref=\"table-header\">\n                <div class=\"tr\">\n                  <div class=\"td table-index\">#</div>\n                  <div class=\"td table-name\">割名</div>\n                  <div class=\"td table-material\">\n                    <div class=\"tr-border\"></div>\n                    材料名\n                  </div>\n                </div>\n              </div>\n              <div class=\"table-body\" ref=\"table-body\">\n                <div ref=\"filled_list\">\n                  <div class=\"tr\"\n                       ref=\"dishes__list\"\n                       v-for=\"(dish, rowIndex) in dishes\"\n                       :key=\"`dish-${rowIndex}`\"\n                  >\n                    <div class=\"td table-index\">{{ rowIndex + 1 + startIndex[index] }}</div>\n                    <div class=\"td table-name\">{{ dish.name }}</div>\n                    <div class=\"td table-material\">\n                      <div class=\"tr-border\">\n                      </div>\n                    <span\n                      v-for=\"(mat, matIndex) in dish.materials.map(\n                        e => `【${e.name}: ${e.value}${e.unit}】`\n                      )\"\n                      :key=\"`mat-${matIndex}`\"\n                      style=\"white-space: normal\"\n                    >\n                      {{ mat }}\n                    </span>\n                    </div>\n                  </div>\n                </div>\n                <div ref=\"empty_list\" v-if=\"index === pagesData.length - 1\">\n                  <div v-if=\"heightSet\">\n                    <div class=\"tr\"\n                         :key=\"rowIndex\"\n                         v-for=\"rowIndex in (emptyHeight > 0 ? Number.parseInt(emptyHeight/30) : [])\"\n                    >\n                      <div class=\"td table-index\">\n                        {{ rowIndex + totalDishes.length }}\n                      </div>\n                      <div class=\"td table-name\"></div>\n                      <div class=\"td table-material\">\n                        <div class=\"tr-border\"></div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"note\" ref=\"note\" v-if=\"index === pagesData.length - 1\">{{ note }}</div>\n          <div class=\"page_footer\">\n            <span style=\"margin-right: 10px\">{{ company.name }}</span>\n            <span>{{ store.name }}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  </pdf-layout>\n</template>\n\n<script>\nimport MenuApi from '@/services/menu'\nimport sortMethods from '@/utils/sort'\nimport PdfLayout from '@/views/layouts/pdf'\nimport { mapActions, mapGetters } from 'vuex'\nimport { SET_LOADING } from '@/store/types'\n\nexport default {\n  components: {\n    PdfLayout\n  },\n  data () {\n    return {\n      name: '',\n      note: '',\n      totalDishes: [],\n      sortedDishes: [],\n      currentIndex: 0,\n      perPage: 25,\n      heightSet: false,\n\n      //\n      pagesData: [],\n      flags: {\n        showTempList: true\n      },\n      emptyHeight: 0,\n      startIndex: [],\n      currentSort: ''\n    }\n  },\n  computed: {\n    ...mapGetters({\n      store: 'store',\n      company: 'company'\n    })\n  },\n  async mounted () {\n    // window.alert(this.getOS())\n    this.setLoading(true)\n    const currentMenu = await MenuApi.getDetails(this.$route.params.id)\n    const filterCate = this.$route.query.filter\n    this.totalDishes = currentMenu.dishes.filter(e => {\n      if (filterCate === 'すべて' || !filterCate.length) {\n        return true\n      } else {\n        return e.category === filterCate\n      }\n    })\n    this.totalDishes = this.$route.query.sort_by ? sortMethods.sort(this.totalDishes, this.$route.query.sort_by) : this.totalDishes\n    console.log(this.totalDishes)\n    this.name = currentMenu.name\n    this.note = currentMenu.note\n    this.startIndex[0] = 0\n    setTimeout(() => {\n      var tableHeight = this.$refs['subpage'].offsetHeight - (10 + 37.795275591 + 25 + 21 + 80)\n      var noteHeight = this.$refs.note.offsetHeight\n      // if (this.getOS() === 'iOS') {\n      //   noteHeight = this.$refs.note.offsetHeight * 0.7\n      // } else {\n      //   noteHeight = this.$refs.note.offsetHeight\n      // }\n\n      let totalTableHeight = 0\n      let currentPage = 0\n      let cutIndex = 0\n      if (this.totalDishes.length) {\n        const rowsHeight = this.$refs['dishes__list'].map(e => e.offsetHeight)\n        let page = [[]]\n        rowsHeight.forEach((height, index) => {\n          // window.alert('row height: ' + height)\n          if (totalTableHeight >= tableHeight) {\n            totalTableHeight = 0\n            currentPage = currentPage + 1\n            page[currentPage] = []\n            cutIndex += page[currentPage - 1].length\n            this.startIndex[currentPage] = cutIndex\n          }\n\n          page[currentPage].push(this.totalDishes[index])\n          if (this.getOS() === 'iOS') {\n            totalTableHeight += height * 0.65\n          } else {\n            totalTableHeight += height\n          }\n          // empty = tableHeight - this.$refs.note.offsetHeight - totalTableHeight\n        })\n        this.pagesData = page\n        let sum = rowsHeight.filter((e, i) => i >= cutIndex).reduce(function (a, b) {\n          return a + b\n        }, 0)\n        this.emptyHeight = tableHeight - noteHeight - sum\n        if (this.emptyHeight < 0) {\n          currentPage = currentPage + 1\n          this.pagesData.push([])\n          this.emptyHeight = tableHeight - noteHeight\n        }\n      } else {\n        this.pagesData = [[]]\n        this.emptyHeight = tableHeight - noteHeight\n      }\n      this.heightSet = true\n      // remove temp page\n      this.flags.showTempList = false\n      this.setLoading(false)\n    }, 200)\n  },\n  methods: {\n    ...mapActions({\n      setLoading: SET_LOADING\n    }),\n    dishesOfPage (currentPage) {\n      if (currentPage === this.totalPage) {\n        return this.totalDishes.slice((currentPage - 1) * 25, this.totalDishes.length - (currentPage - 1) * 25)\n      }\n      return this.totalDishes.slice((currentPage - 1) * 25, 25)\n    },\n    printWindow () {\n      window.print()\n    },\n    getOS () {\n      var userAgent = window.navigator.userAgent\n      var platform = window.navigator.platform\n      var macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K']\n      var windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE']\n      var iosPlatforms = ['iPhone', 'iPod']\n      var os = null\n\n      if (macosPlatforms.indexOf(platform) !== -1) {\n        os = 'Mac OS'\n      } else if (iosPlatforms.indexOf(platform) !== -1) {\n        os = 'iOS'\n      } else if (windowsPlatforms.indexOf(platform) !== -1) {\n        os = 'Windows'\n      } else if (/Android/.test(userAgent)) {\n        os = 'Android'\n      } else if (!os && /Linux/.test(platform)) {\n        os = 'Linux'\n      }\n\n      return os\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.red {\n  color: red;\n}\n\n.menu-title {\n  margin-top: 10px;\n}\n\n.name {\n  padding: 0;\n  margin: 0;\n  font-size: 17px;\n}\n\n.page_footer {\n  position: absolute;\n  bottom: 10px;\n  right: 10px;\n}\n\n.table {\n  margin-top: 25px;\n  font-size: 11px;\n  width: 100%;\n  border: none;\n  border-collapse: collapse;\n\n  caption {\n    padding-bottom: 0.5em;\n  }\n\n  .th,\n  .td {\n    padding: 6px;\n    display: inline-block;\n  }\n\n  .tr {\n    height: auto;\n    min-height: 30px;\n    border-bottom: 2px solid #dcdcdc;\n    position: relative;\n\n    &-border {\n      position: absolute;\n      width: 150px;\n      height: 100%;\n      border-left: 1px solid #c5c5c5;\n      border-right: 1px solid #c5c5c5;\n      top: 0px;\n      left: 30px;\n    }\n  }\n\n  .td {\n    white-space: nowrap;\n    vertical-align: top;\n    height: 100%;\n  }\n\n  .th {\n    padding: 3.2px;\n    vertical-align: middle;\n    text-align: center;\n  }\n\n  &-header {\n    border-bottom: 2px solid #dcdcdc;\n\n    .th {\n      border-top: none;\n    }\n  }\n\n  &-content {\n    height: 100%;\n  }\n\n  &-index {\n    width: 30px\n  }\n\n  &-name {\n    width: 150px\n  }\n\n  &-material {\n    width: 488px\n  }\n}\n\n.note {\n  min-height: 149px;\n  background-color: #efefef;\n  font-size: 13px;\n  padding: 10px;\n  border-top: 1px solid #dcdcdc;\n  white-space: pre-wrap;\n}\n\n</style>\n"],"sourceRoot":"src/views/user/menu-detail"}]}