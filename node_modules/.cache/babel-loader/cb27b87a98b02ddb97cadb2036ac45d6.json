{"remainingRequest":"/home/quan/Documents/Projects/django-vue/frontend_test/node_modules/babel-loader/lib/index.js!/home/quan/Documents/Projects/django-vue/frontend_test/node_modules/eslint-loader/index.js??ref--13-0!/home/quan/Documents/Projects/django-vue/frontend_test/src/store/actions.js","dependencies":[{"path":"/home/quan/Documents/Projects/django-vue/frontend_test/src/store/actions.js","mtime":1615822194522},{"path":"/home/quan/Documents/Projects/django-vue/frontend_test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/quan/Documents/Projects/django-vue/frontend_test/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/quan/Documents/Projects/django-vue/frontend_test/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _defineProperty from \"/home/quan/Documents/Projects/django-vue/frontend_test/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/quan/Documents/Projects/django-vue/frontend_test/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n\nvar _LOGIN$LOGOUT$SET_LOA;\n\nimport Auth from \"../services/auth\";\nimport { LOGIN, LOGOUT, SET_LOADING, IS_ADMIN_PAGE, SET_CURRENT_STORE, VERIFY_TOKEN, SET_CURRENT_COMPANY, UPDATE_STORE_UNITS, LOGIN_PREVIEW } from \"./types\";\nexport default (_LOGIN$LOGOUT$SET_LOA = {}, _defineProperty(_LOGIN$LOGOUT$SET_LOA, LOGIN, function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(_ref, data) {\n    var commit, dispatch, state, res;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            commit = _ref.commit, dispatch = _ref.dispatch, state = _ref.state;\n            // loading\n            commit(SET_LOADING, true);\n            _context.prev = 2;\n            _context.next = 5;\n            return Auth.login(data);\n\n          case 5:\n            res = _context.sent;\n\n            if (!res.status) {\n              _context.next = 13;\n              break;\n            }\n\n            if (data.admin_id) {\n              commit(LOGIN_PREVIEW, res.data);\n            }\n\n            commit(LOGIN, res.data);\n            commit(SET_LOADING, false);\n            return _context.abrupt(\"return\", res.data);\n\n          case 13:\n            throw new Error('Invalid email or password!');\n\n          case 14:\n            _context.next = 21;\n            break;\n\n          case 16:\n            _context.prev = 16;\n            _context.t0 = _context[\"catch\"](2);\n            console.warn(_context.t0);\n            commit(SET_LOADING, false);\n            return _context.abrupt(\"return\", null);\n\n          case 21:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[2, 16]]);\n  }));\n\n  return function (_x, _x2) {\n    return _ref2.apply(this, arguments);\n  };\n}()), _defineProperty(_LOGIN$LOGOUT$SET_LOA, LOGOUT, function (_ref3) {\n  var commit = _ref3.commit,\n      dispatch = _ref3.dispatch,\n      state = _ref3.state;\n  commit(LOGOUT);\n}), _defineProperty(_LOGIN$LOGOUT$SET_LOA, SET_LOADING, function (_ref4, isLoading) {\n  var commit = _ref4.commit,\n      dispatch = _ref4.dispatch,\n      state = _ref4.state;\n  commit(SET_LOADING, isLoading);\n}), _defineProperty(_LOGIN$LOGOUT$SET_LOA, IS_ADMIN_PAGE, function (_ref5) {\n  var commit = _ref5.commit,\n      dispatch = _ref5.dispatch,\n      state = _ref5.state;\n  commit(IS_ADMIN_PAGE);\n}), _defineProperty(_LOGIN$LOGOUT$SET_LOA, UPDATE_STORE_UNITS, function (_ref6, units) {\n  var commit = _ref6.commit,\n      dispatch = _ref6.dispatch,\n      state = _ref6.state;\n  commit(UPDATE_STORE_UNITS, units);\n}), _defineProperty(_LOGIN$LOGOUT$SET_LOA, SET_CURRENT_STORE, function () {\n  var _ref9 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(_ref7, _ref8) {\n    var commit, dispatch, state, storeId, companyId, res;\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            commit = _ref7.commit, dispatch = _ref7.dispatch, state = _ref7.state;\n            storeId = _ref8.storeId, companyId = _ref8.companyId;\n            commit(SET_LOADING, true);\n            _context2.next = 5;\n            return Auth.checkStore(storeId, companyId);\n\n          case 5:\n            res = _context2.sent;\n            commit(SET_LOADING, false);\n\n            if (!res.data.store) {\n              _context2.next = 13;\n              break;\n            }\n\n            commit(SET_CURRENT_STORE, res.data.store);\n            commit(SET_CURRENT_COMPANY, res.data.company);\n            return _context2.abrupt(\"return\", res);\n\n          case 13:\n            throw new Error('Invalid store id');\n\n          case 14:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x3, _x4) {\n    return _ref9.apply(this, arguments);\n  };\n}()), _defineProperty(_LOGIN$LOGOUT$SET_LOA, VERIFY_TOKEN, function () {\n  var _ref11 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(_ref10) {\n    var commit, dispatch, state, token, res;\n    return regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            commit = _ref10.commit, dispatch = _ref10.dispatch, state = _ref10.state;\n            console.log('Verify token');\n            commit(SET_LOADING, true);\n            token = localStorage.getItem('preview_token') || localStorage.getItem('token');\n\n            if (token) {\n              _context3.next = 7;\n              break;\n            }\n\n            commit(SET_LOADING, false);\n            return _context3.abrupt(\"return\", new Promise(function (resolve) {\n              setTimeout(function () {\n                return resolve(false);\n              });\n            }));\n\n          case 7:\n            _context3.next = 9;\n            return Auth.verifyToken(token);\n\n          case 9:\n            res = _context3.sent;\n            commit(SET_LOADING, false);\n\n            if (res) {\n              _context3.next = 13;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", null);\n\n          case 13:\n            if (!res.data.user) {\n              _context3.next = 18;\n              break;\n            }\n\n            commit(VERIFY_TOKEN, res.data);\n            return _context3.abrupt(\"return\", res.data);\n\n          case 18:\n            return _context3.abrupt(\"return\", null);\n\n          case 19:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function (_x5) {\n    return _ref11.apply(this, arguments);\n  };\n}()), _LOGIN$LOGOUT$SET_LOA);",{"version":3,"sources":["/home/quan/Documents/Projects/django-vue/frontend_test/src/store/actions.js"],"names":["Auth","LOGIN","LOGOUT","SET_LOADING","IS_ADMIN_PAGE","SET_CURRENT_STORE","VERIFY_TOKEN","SET_CURRENT_COMPANY","UPDATE_STORE_UNITS","LOGIN_PREVIEW","data","commit","dispatch","state","login","res","status","admin_id","Error","console","warn","isLoading","units","storeId","companyId","checkStore","store","company","log","token","localStorage","getItem","Promise","resolve","setTimeout","verifyToken","user"],"mappings":"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","sourcesContent":["import Auth from '../services/auth'\nimport {\n  LOGIN,\n  LOGOUT,\n  SET_LOADING,\n  IS_ADMIN_PAGE,\n  SET_CURRENT_STORE,\n  VERIFY_TOKEN,\n  SET_CURRENT_COMPANY,\n  UPDATE_STORE_UNITS,\n  LOGIN_PREVIEW\n} from './types'\n\nexport default {\n  [LOGIN]: async ({ commit, dispatch, state }, data) => {\n    // loading\n    commit(SET_LOADING, true)\n    try {\n      const res = await Auth.login(data)\n      if (res.status) {\n        if (data.admin_id) {\n          commit(LOGIN_PREVIEW, res.data)\n        }\n        commit(LOGIN, res.data)\n        commit(SET_LOADING, false)\n        return res.data\n      } else {\n        throw new Error('Invalid email or password!')\n      }\n    } catch (e) {\n      console.warn(e)\n      commit(SET_LOADING, false)\n      return null\n    }\n  },\n  [LOGOUT]: ({ commit, dispatch, state }) => {\n    commit(LOGOUT)\n  },\n  [SET_LOADING]: ({ commit, dispatch, state }, isLoading) => {\n    commit(SET_LOADING, isLoading)\n  },\n  [IS_ADMIN_PAGE]: ({ commit, dispatch, state }) => {\n    commit(IS_ADMIN_PAGE)\n  },\n  [UPDATE_STORE_UNITS]: ({ commit, dispatch, state }, units) => {\n    commit(UPDATE_STORE_UNITS, units)\n  },\n  [SET_CURRENT_STORE]: async ({ commit, dispatch, state }, { storeId, companyId }) => {\n    commit(SET_LOADING, true)\n\n    const res = await Auth.checkStore(storeId, companyId)\n    commit(SET_LOADING, false)\n\n    if (res.data.store) {\n      commit(SET_CURRENT_STORE, res.data.store)\n      commit(SET_CURRENT_COMPANY, res.data.company)\n      return res\n    } else {\n      throw new Error('Invalid store id')\n    }\n  },\n  [VERIFY_TOKEN]: async ({ commit, dispatch, state }) => {\n    console.log('Verify token')\n    commit(SET_LOADING, true)\n\n    const token = localStorage.getItem('preview_token') || localStorage.getItem('token')\n\n    if (!token) {\n      commit(SET_LOADING, false)\n      return new Promise(resolve => {\n        setTimeout(() => resolve(false))\n      })\n    }\n\n    const res = await Auth.verifyToken(token)\n    commit(SET_LOADING, false)\n\n    if (!res) {\n      return null\n    }\n\n    if (res.data.user) {\n      commit(VERIFY_TOKEN, res.data)\n      return res.data\n    } else {\n      return null\n    }\n  }\n}\n"]}]}